<!doctype HTML>
<html>
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
        <link rel="stylesheet" href="styles.css">
        <link rel="shortcut icon" href="#" />
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD" crossorigin="anonymous">
    </head>

    <script src="https://aframe.io/releases/1.0.4/aframe.min.js"></script>
    <script src="https://unpkg.com/aframe-look-at-component@0.8.0/dist/aframe-look-at-component.min.js"></script>
    <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar-nft.js"></script>

    
    <script src="https://raw.githack.com/fcor/arjs-gestures/master/dist/gestures.js"></script>
    

    <script>
       const urlParams = new URLSearchParams(window.location.search);
        const img = urlParams.get('img');
        const lat = urlParams.get('lat');
        const long = urlParams.get('long');
        console.log(img);

        document.addEventListener("DOMContentLoaded", function(event) { 

            
            const sound = document.getElementById("sound");
            //sound.removeAttribute("src");
           //const soundGps = document.getElementById("sound-gps");
            const img1 = document.getElementById("img1");
            img1.removeAttribute("src");
            const img2 = document.getElementById("img2");
            img2.removeAttribute("src");

            switch(img){
                case 'villaggio':
                    console.log('PROVA');
                    sound.setAttribute('gps-entity-place', {latitude: 44.1418, longitude: 12.2442});
                    //sound.setAttribute('src',"./asset/2d/sound1.mp3");
                    //soundGps.setAttribute('gps-entity-place', 'latitude: 43.958; longitude: 12.736');
                    img1.setAttribute('src',"./asset/2d/render-villaggio.webp");
                    img2.setAttribute('src',"./asset/2d/render-capanna.webp");
                    img1.setAttribute('scale',"1 0.6 1");
                    img2.setAttribute('scale',"1 0.6 1");
                    img1.setAttribute('position',"0.5 2.2 -3");
                    img2.setAttribute('position',"1.5 1 -3");
                    img1.setAttribute('gps-entity-place', {latitude: 44.1418, longitude: 12.2442});
                    img2.setAttribute('gps-entity-place', {latitude: 44.1418, longitude: 12.2442});
                    
                     /*{latitude: 43.958, longitude: 12.736}
                     img1.setAttribute('gps-entity-place', {latitude: 44.1412, longitude: 12.2440});
                    img2.setAttribute('gps-entity-place', {latitude: 44.1412, longitude: 12.2440});*/
                    break;
                case 'mercato':
                    //12.743060 -  43963217      
                    sound.setAttribute('src',"./asset/2d/sound2.mp3");
                    break;
                case 'rocca':
                    //12.741678 - 43.963245
                    sound.setAttribute('src',"./asset/2d/sound2.mp3");
                    break;
            }
            //console.log(sound);
            console.log(img1.getAttribute('gps-entity-place'));
            console.log(img2.getAttribute('gps-entity-place'));
            
        });
        
    </script>

    <body>
        <h1 id="coord" class="white">Muovi lentamente il telefono</h1>

        <a-scene embedded  loading-screen="enabled: false;" arjs="sourceType: webcam; debugUIEnabled: false;" vr-mode-ui="enabled: false">
        <!--<a-scene embedded arjs='sourceType: webcam; videoTexture: true; debugUIEnabled: false;'
            vr-mode-ui="enabled: false"  gesture-detector id="scene">

            PARAMETRI TELEFONO 
                <a-scene embedded arjs='sourceType: webcam; patternRatio: 0.75 trackingMethod: best maxDetectionRate: 60 detectionMode: mono' renderer='antialias: true; alpha: true; precision: medium;' vr-mode-ui="enabled: false" stats>
        -->

        <!--      
        
        
        <a-entity id="river" geometry="primitive: plane" material="color: blue" look-at="[gps-camera]" gesture-handler class="clickable" 
            gps-entity-place="latitude: 44.13872998373266; longitude: 12.244238611211696; " 
          position="0 0 -1" sound="src: url(./asset/2d/sound.mp3); autoplay: true"></a-entity>
        
        
        
        <a-entity id="sound" geometry="primitive: plane" material="color: blue" look-at="[gps-camera]" gesture-handler class="clickable" 
            gps-entity-place="latitude: 44.13872998373266; longitude: 12.244238611211696; " position="0 0 -1" sound="src: url(./asset/2d/sound.mp3); autoplay: true"></a-entity>
        <a-assets id="soung-gps">
                <audio src="./asset/2d/sound1.mp3" preload="auto"></audio>
            </a-assets gps-entity-place="latitude: 44.1417; longitude: 12.2442; " preload="auto">

            <a-sound id="sound" src="src: url(/asset/2d/sound1.mp3)" position="0 2 5"></a-sound>
        -->    

        <a-entity id="sound" geometry="primitive: plane" material="color: blue" look-at="[gps-camera]" gesture-handler class="clickable" 
            gps-entity-place="latitude: 44.1418; longitude: 12.2443; " position="0 0 -1" sound="src: url(./asset/2d/sound1.mp3); autoplay: true"></a-entity>
           

            <a-entity geometry="primitive: plane" src="./asset/2d/render-capanna.webp" scale="1 0.6 1" rotation="0 0 0" position="0.5 2.2 -3" look-at="[gps-camera]"  id="img1"
            class="clickable" gps-entity-place="latitude: 44.1418; longitude: 12.2442; "/></a-image>

            <a-entity geometry="primitive: plane" src="./asset/2d/render-capanna.webp" scale="1 0.6 1" rotation="0 0 0" position="1.5 1 -3" look-at="[gps-camera]"  id="img2"
            class="clickable" gps-entity-place="latitude: 44.1418; longitude: 12.2442; "/></a-image>
            
            <a-camera gps-camera rotation-reader look-controls-enabled='false' gps-projected-camera='gpsMinDistance: 5'
            arjs-look-controls='smoothingFactor: 0.1' class="clickable"> </a-camera>
        </a-scene> 

        <fieldset class='glass'>
            <legend>Interagisci con l'immagine</legend>
                        
            <div>
              <img src='./asset/move.gif' width=45 >
              <p>Usa un dito per spostare</p>
            </div>

        </fieldset>

    </body>
</html>
